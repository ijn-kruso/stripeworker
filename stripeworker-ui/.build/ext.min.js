"use strict";var __StripeExtExports=(()=>{var Ze=Object.create;var G=Object.defineProperty,Qe=Object.defineProperties,Xe=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertyNames,Ee=Object.getOwnPropertySymbols,rt=Object.getPrototypeOf,Be=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var Ie=(e,t,o)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,F=(e,t)=>{for(var o in t||(t={}))Be.call(t,o)&&Ie(e,o,t[o]);if(Ee)for(var o of Ee(t))ot.call(t,o)&&Ie(e,o,t[o]);return e},X=(e,t)=>Qe(e,et(t));var B=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,o)=>(typeof require!="undefined"?require:t)[o]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),nt=(e,t)=>{for(var o in t)G(e,o,{get:t[o],enumerable:!0})},Q=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of tt(t))!Be.call(e,i)&&i!==o&&G(e,i,{get:()=>t[i],enumerable:!(s=Xe(t,i))||s.enumerable});return e},H=(e,t,o)=>(Q(e,t,"default"),o&&Q(o,t,"default")),J=(e,t,o)=>(o=e!=null?Ze(rt(e)):{},Q(t||!e||!e.__esModule?G(o,"default",{value:e,enumerable:!0}):o,e)),st=e=>Q(G({},"__esModule",{value:!0}),e);var E=(e,t,o)=>new Promise((s,i)=>{var l=u=>{try{a(o.next(u))}catch(d){i(d)}},p=u=>{try{a(o.throw(u))}catch(d){i(d)}},a=u=>u.done?s(u.value):Promise.resolve(u.value).then(l,p);a((o=o.apply(e,t)).next())});var de=P(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.SDK_VERSION=void 0;ee.SDK_VERSION="8.10.0"});var K=P(r=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.Tooltip=r.TextField=r.TextArea=r.Tabs=r.TableRow=r.Table=r.TableHeaderCell=r.TableHead=r.TableFooter=r.TableCell=r.TableBody=r.Tab=r.TabPanels=r.TabPanel=r.TabList=r.Switch=r.StripeFileUploader=r.Spinner=r.Sparkline=r.SignInView=r.SettingsView=r.Select=r.Radio=r.Menu=r.MenuItem=r.MenuGroup=r.List=r.ListItem=r.Link=r.LineChart=r.Inline=r.Img=r.Icon=r.FormFieldGroup=r.FocusView=r.Divider=r.DateField=r.ContextView=r.Chip=r.ChipList=r.Checkbox=r.Button=r.ButtonGroup=r.Box=r.BarChart=r.Banner=r.Badge=r.Accordion=r.AccordionItem=void 0;var it=B("react/jsx-runtime"),at=B("@remote-ui/react"),ct=de(),lt=e=>{let t=e.displayName||e.toString(),o=s=>(0,it.jsx)(e,Object.assign({},s,{wrappedComponentName:t,sdkVersion:ct.SDK_VERSION,schemaVersion:"v8"}));return o.wrappedComponentName=t,o},c=(e,t,o)=>{let s=(0,at.createRemoteReactComponent)(e,{fragmentProps:t});return o?lt(s):s};r.AccordionItem=c("AccordionItem",["title","actions","media","subtitle"],!0);r.Accordion=c("Accordion",[],!0);r.Badge=c("Badge",[],!0);r.Banner=c("Banner",["actions","description","title"],!0);r.BarChart=c("BarChart",[],!0);r.Box=c("Box",[],!0);r.ButtonGroup=c("ButtonGroup",["menuTrigger"],!0);r.Button=c("Button",[],!0);r.Checkbox=c("Checkbox",["label"],!0);r.ChipList=c("ChipList",[],!0);r.Chip=c("Chip",[],!0);r.ContextView=c("ContextView",["actions","banner","footerContent","primaryAction","secondaryAction"],!0);r.DateField=c("DateField",["label"],!0);r.Divider=c("Divider",[],!0);r.FocusView=c("FocusView",["footerContent","primaryAction","secondaryAction"],!0);r.FormFieldGroup=c("FormFieldGroup",[],!0);r.Icon=c("Icon",[],!0);r.Img=c("Img",[],!0);r.Inline=c("Inline",[],!0);r.LineChart=c("LineChart",[],!0);r.Link=c("Link",[],!0);r.ListItem=c("ListItem",["icon","image","secondaryTitle","title","value"],!0);r.List=c("List",[],!0);r.MenuGroup=c("MenuGroup",["title"],!0);r.MenuItem=c("MenuItem",[],!0);r.Menu=c("Menu",["trigger"],!0);r.Radio=c("Radio",["label"],!0);r.Select=c("Select",["label"],!0);r.SettingsView=c("SettingsView",[],!0);r.SignInView=c("SignInView",["descriptionActionContents","footerContent"],!0);r.Sparkline=c("Sparkline",[],!0);r.Spinner=c("Spinner",[],!0);r.StripeFileUploader=c("StripeFileUploader",[],!0);r.Switch=c("Switch",["label"],!0);r.TabList=c("TabList",[],!0);r.TabPanel=c("TabPanel",[],!0);r.TabPanels=c("TabPanels",[],!0);r.Tab=c("Tab",[],!0);r.TableBody=c("TableBody",[],!0);r.TableCell=c("TableCell",[],!0);r.TableFooter=c("TableFooter",[],!0);r.TableHead=c("TableHead",[],!0);r.TableHeaderCell=c("TableHeaderCell",[],!0);r.Table=c("Table",[],!0);r.TableRow=c("TableRow",[],!0);r.Tabs=c("Tabs",[],!0);r.TextArea=c("TextArea",["label"],!0);r.TextField=c("TextField",["label"],!0);r.Tooltip=c("Tooltip",["trigger"],!0)});var fe=P((rr,Ae)=>{"use strict";var ut=function(e,t,o,s,i,l,p,a){if(!e){var u;if(t===void 0)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[o,s,i,l,p,a],n=0;u=new Error(t.replace(/%s/g,function(){return d[n++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}};Ae.exports=ut});var R=P(j=>{"use strict";var pt=j&&j.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(j,"__esModule",{value:!0});j.getHostEndpoint=void 0;var dt=pt(fe()),ft=()=>{var e;let t=(e=globalThis.__StripeExtExports)===null||e===void 0?void 0:e.endpoint;return(0,dt.default)(t,"hostEndpoint has not been initialized"),t};j.getHostEndpoint=ft});var me=P(te=>{"use strict";Object.defineProperty(te,"__esModule",{value:!0});te.stripeApiFetch=void 0;var mt=R(),gt=(e,t)=>{try{return(0,mt.getHostEndpoint)().call.stripeApiFetch(e,t)}catch(o){throw console.error("error calling stripe fetch",o),o}};te.stripeApiFetch=gt});var Re=P(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.clipboardWriteText=void 0;var ht=R(),wt=(e="")=>(0,ht.getHostEndpoint)().call.clipboardWriteText(e);re.clipboardWriteText=wt});var Oe=P(U=>{"use strict";var _t=U&&U.__createBinding||(Object.create?function(e,t,o,s){s===void 0&&(s=o);var i=Object.getOwnPropertyDescriptor(t,o);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,i)}:function(e,t,o,s){s===void 0&&(s=o),e[s]=t[o]}),yt=U&&U.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),bt=U&&U.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var o in e)o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)&&_t(t,e,o);return yt(t,e),t};Object.defineProperty(U,"__esModule",{value:!0});U.useRefreshDashboardData=void 0;var xt=bt(B("react")),St=R(),Pt=()=>xt.useCallback(()=>(0,St.getHostEndpoint)().call.refreshDashboardData(),[]);U.useRefreshDashboardData=Pt});var he=P(v=>{"use strict";var vt=v&&v.__awaiter||function(e,t,o,s){function i(l){return l instanceof o?l:new o(function(p){p(l)})}return new(o||(o=Promise))(function(l,p){function a(n){try{d(s.next(n))}catch(f){p(f)}}function u(n){try{d(s.throw(n))}catch(f){p(f)}}function d(n){n.done?l(n.value):i(n.value).then(a,u)}d((s=s.apply(e,t||[])).next())})},Ct=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(v,"__esModule",{value:!0});v.AUTHORIZATION_VALUE=v.AUTHORIZATION_HEADER=v.createHttpClient=v.STRIPE_API_KEY=v.StripeAppsHttpClient=void 0;var Tt=Ct(fe()),Et=me(),It=/[ps]k_(test|live)_[A-Za-z0-9]+/,ge=class{constructor(t){this._resp=t}getHeaders(){return this._resp.headers}getStatusCode(){return this._resp.status}getRawResponse(){return this._resp}toStream(){throw new Error("Streams have not been implemented in the Stripe HTTP client")}toJSON(){let{json:t}=this._resp;return t===void 0?Promise.reject(new Error("Response body undefined")):Promise.resolve(t)}},oe=class{constructor(t){this._fetch=t}getClientName(){return"stripe-ui-extension"}makeRequest(t,o,s,i,l,p,a,u){return vt(this,void 0,void 0,function*(){(0,Tt.default)(a==="https","Must use https connections in UI extensions");let d={method:i,headers:l};p&&(d.body=p);let n=l.Authorization;if(n&&It.test(n))throw new Error("Do not use actual stripe keys when using the Stripe JS API client with UI extesions.\n\n Instead, use `STRIPE_API_KEY` from `@stripe/ui-extension-sdk/http_client` as a placeholder.");let f=yield this._fetch(s,d);return new ge(f)})}};v.StripeAppsHttpClient=oe;v.STRIPE_API_KEY="DO_NOT_PASS_A_REAL_API_KEY";var Bt=()=>new oe(Et.stripeApiFetch);v.createHttpClient=Bt;v.AUTHORIZATION_HEADER="Authorization";v.AUTHORIZATION_VALUE=`Bearer ${v.STRIPE_API_KEY}`});var Ue=P(z=>{"use strict";var At=z&&z.__awaiter||function(e,t,o,s){function i(l){return l instanceof o?l:new o(function(p){p(l)})}return new(o||(o=Promise))(function(l,p){function a(n){try{d(s.next(n))}catch(f){p(f)}}function u(n){try{d(s.throw(n))}catch(f){p(f)}}function d(n){n.done?l(n.value):i(n.value).then(a,u)}d((s=s.apply(e,t||[])).next())})};Object.defineProperty(z,"__esModule",{value:!0});z.getDashboardUserEmail=void 0;var Rt=R(),ke=he(),Ot=()=>At(void 0,void 0,void 0,function*(){try{let e=yield(0,Rt.getHostEndpoint)().call.stripeApiFetch("/v1/user/email",{headers:{[ke.AUTHORIZATION_HEADER]:ke.AUTHORIZATION_VALUE}});return e.ok?(e.email=e.json.email,e):Promise.reject(e)}catch(e){throw console.error("Error getting dashboard user email",e),e}});z.getDashboardUserEmail=Ot});var De=P(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.getUserAuthorizedPermissions=void 0;var kt=R(),Ut=()=>(0,kt.getHostEndpoint)().call.getUserAuthorizedPermissions();ne.getUserAuthorizedPermissions=Ut});var Le=P(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.isPermissionAuthorized=void 0;var Dt=R(),Lt=e=>(0,Dt.getHostEndpoint)().call.isPermissionAuthorized(e);se.isPermissionAuthorized=Lt});var Ve=P(ie=>{"use strict";Object.defineProperty(ie,"__esModule",{value:!0});ie.isSourceInAuthorizedCSP=void 0;var Vt=R(),Mt=e=>(0,Vt.getHostEndpoint)().call.isSourceInAuthorizedCSP(e);ie.isSourceInAuthorizedCSP=Mt});var Me=P(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.createOAuthState=void 0;var qt=R(),Ft=(e="")=>(0,qt.getHostEndpoint)().call.createOAuthState(e);ae.createOAuthState=Ft});var Fe=P(qe=>{"use strict";Object.defineProperty(qe,"__esModule",{value:!0})});var He=P(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.fetchStripeSignature=void 0;var Ht=R(),Jt=e=>(0,Ht.getHostEndpoint)().call.fetchStripeSignature(e);ce.fetchStripeSignature=Jt});var Je=P(N=>{"use strict";var jt=N&&N.__awaiter||function(e,t,o,s){function i(l){return l instanceof o?l:new o(function(p){p(l)})}return new(o||(o=Promise))(function(l,p){function a(n){try{d(s.next(n))}catch(f){p(f)}}function u(n){try{d(s.throw(n))}catch(f){p(f)}}function d(n){n.done?l(n.value):i(n.value).then(a,u)}d((s=s.apply(e,t||[])).next())})};Object.defineProperty(N,"__esModule",{value:!0});N.showToast=void 0;var zt=R(),Nt=(e,...t)=>jt(void 0,[e,...t],void 0,function*(o,s={}){return(0,zt.getHostEndpoint)().call.showToast(o,s)});N.showToast=Nt});var je=P(x=>{"use strict";var $t=x&&x.__createBinding||(Object.create?function(e,t,o,s){s===void 0&&(s=o);var i=Object.getOwnPropertyDescriptor(t,o);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,s,i)}:function(e,t,o,s){s===void 0&&(s=o),e[s]=t[o]}),A=x&&x.__exportStar||function(e,t){for(var o in e)o!=="default"&&!Object.prototype.hasOwnProperty.call(t,o)&&$t(t,e,o)};Object.defineProperty(x,"__esModule",{value:!0});A(R(),x);A(me(),x);A(Re(),x);A(Oe(),x);A(Ue(),x);A(De(),x);A(he(),x);A(Le(),x);A(Ve(),x);A(Me(),x);A(Fe(),x);A(He(),x);A(Je(),x)});var M={};nt(M,{BUILD_TIME:()=>Zt,ProductListView:()=>Ge,default:()=>Qt});var b=J(K());var le=J(je());var we="https://stripeworker.workers.dev";function ze(e){let t={user_id:e.userId,account_id:e.accountId};return{post(l){return E(this,arguments,function*(s,i={}){var d;let p=F(F({},t),i),a=yield(0,le.fetchStripeSignature)(),u=yield fetch(`${we}${s}`,{method:"POST",headers:{"Content-Type":"application/json","Stripe-Signature":a},body:JSON.stringify(p)});if(!u.ok){let n=yield u.json().catch(()=>({error:"Request failed"}));throw new $(u.status,(d=n.error)!=null?d:"Request failed")}return u.json()})},get(l){return E(this,arguments,function*(s,i={}){var d;let p=yield(0,le.fetchStripeSignature)(),a=new URLSearchParams(X(F({},i),{account_id:e.accountId})),u=yield fetch(`${we}${s}?${a}`,{method:"GET",headers:{"Stripe-Signature":p}});if(!u.ok){let n=yield u.json().catch(()=>({error:"Request failed"}));throw new $(u.status,(d=n.error)!=null?d:"Request failed")}return u.json()})},delete(s){return E(this,null,function*(){var p;let i=yield(0,le.fetchStripeSignature)(),l=yield fetch(`${we}${s}?account_id=${e.accountId}`,{method:"DELETE",headers:{"Stripe-Signature":i}});if(!l.ok){let a=yield l.json().catch(()=>({error:"Request failed"}));throw new $(l.status,(p=a.error)!=null?p:"Request failed")}return l.json()})},uploadFile(s,i){return E(this,null,function*(){let l=yield fetch(s,{method:"PUT",headers:{"Content-Type":i.type||"text/csv"},body:i});if(!l.ok)throw new $(l.status,"File upload failed")})}}}var $=class extends Error{constructor(o,s){super(s);this.status=o;this.name="ApiError"}};var W=B("react"),C=J(K());var T=B("react/jsx-runtime"),Yt=({api:e})=>{var I;let[t,o]=(0,W.useState)(!1),[s,i]=(0,W.useState)(null),[l,p]=(0,W.useState)(null),[a,u]=(0,W.useState)(null),d=()=>E(void 0,null,function*(){o(!0),p(null),u(null),i(null);try{let S=yield e.post("/export/start");i(S),S.status==="processing"?yield n(S.id):S.status==="completed"&&(yield f(S.id))}catch(S){p(S instanceof Error?S.message:"Export failed")}finally{o(!1)}}),n=S=>E(void 0,null,function*(){let Z=0;for(;Z<60;){yield new Promise(O=>setTimeout(O,5e3));try{let O=yield e.get(`/jobs/${S}`);if(i(O),O.status==="completed"){yield f(S);return}else if(O.status==="failed"||O.status==="cancelled"){p(`Export ${O.status}`);return}}catch(O){console.error("Poll error:",O)}Z++}p("Export timed out")}),f=S=>E(void 0,null,function*(){try{let V=yield e.get(`/export/${S}/download`);u(V.downloadUrl)}catch(V){p(V instanceof Error?V.message:"Failed to get download link")}}),k=()=>{a&&window.open(a,"_blank")};return(0,T.jsxs)(C.Box,{css:{stack:"y",gap:"small"},children:[l&&(0,T.jsx)(C.Banner,{type:"critical",title:"Export Error",description:l,onDismiss:()=>p(null)}),s&&s.status==="processing"&&(0,T.jsxs)(C.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,T.jsx)(C.Spinner,{size:"small"}),(0,T.jsxs)(C.Box,{css:{color:"secondary"},children:["Exporting ",s.processedRows," products..."]})]}),a&&(0,T.jsx)(C.Banner,{type:"default",title:"Export Complete",description:`Successfully exported ${(I=s==null?void 0:s.totalRows)!=null?I:0} products.`,actions:(0,T.jsx)(C.Button,{onPress:k,children:"Download CSV"})}),(0,T.jsx)(C.Button,{type:"primary",onPress:d,disabled:t,children:t?(0,T.jsxs)(C.Box,{css:{stack:"x",gap:"xsmall",alignY:"center"},children:[(0,T.jsx)(C.Spinner,{size:"small"}),(0,T.jsx)("span",{children:"Exporting..."})]}):(0,T.jsxs)(C.Box,{css:{stack:"x",gap:"xsmall",alignY:"center"},children:[(0,T.jsx)(C.Icon,{name:"download"}),(0,T.jsx)("span",{children:"Export Products to CSV"})]})})]})},Ne=Yt;var L=B("react"),h=J(K());var g=B("react/jsx-runtime"),Gt=({api:e})=>{var _e,ye,be,xe,Se,Pe,ve,Ce,Te;let[t,o]=(0,L.useState)(null),[s,i]=(0,L.useState)(!1),[l,p]=(0,L.useState)(!1),[a,u]=(0,L.useState)(null),[d,n]=(0,L.useState)(null),[f,k]=(0,L.useState)(!1),I=(0,L.useRef)(null),S=()=>{var y;(y=I.current)==null||y.click()},V=y=>{var D;let q=(D=y.target.files)==null?void 0:D[0];if(q){if(!q.name.toLowerCase().endsWith(".csv")){n("Please select a CSV file");return}o(q),n(null),u(null)}},Z=()=>E(void 0,null,function*(){if(!!t){i(!0),n(null);try{let y=yield e.post("/import/upload-url",{filename:t.name,contentType:t.type||"text/csv"});yield e.uploadFile(y.uploadUrl,t),p(!0);let ue=yield e.post(`/import/${y.jobId}/start`,{dryRun:f});u(ue),yield O(y.jobId)}catch(y){n(y instanceof Error?y.message:"Upload failed")}finally{i(!1),p(!1)}}}),O=y=>E(void 0,null,function*(){let q=0;for(;q<600;){try{let D=yield e.post(`/import/${y}/process`,{batchSize:100});if(u(D),D.status==="completed"||D.status==="failed"||D.status==="cancelled")return;yield new Promise(pe=>setTimeout(pe,100))}catch(D){console.error("Chunk processing error:",D),yield new Promise(pe=>setTimeout(pe,3e3))}q++}n("Import timed out")}),Ke=()=>E(void 0,null,function*(){if(!(!a||a.status!=="processing"))try{yield e.delete(`/jobs/${a.id}`),u(y=>y?X(F({},y),{status:"cancelled"}):null)}catch(y){console.error("Cancel error:",y)}}),We=()=>!a||a.totalRows===0?0:Math.round(a.processedRows/a.totalRows*100);return(0,g.jsxs)(h.Box,{css:{stack:"y",gap:"small"},children:[(0,g.jsx)("input",{ref:I,type:"file",accept:".csv",style:{display:"none"},onChange:V}),d&&(0,g.jsx)(h.Banner,{type:"critical",title:"Import Error",description:d,onDismiss:()=>n(null)}),!l&&!a&&(0,g.jsxs)(h.Box,{css:{stack:"y",gap:"small"},children:[(0,g.jsxs)(h.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,g.jsxs)(h.Button,{type:"secondary",onPress:S,children:[(0,g.jsx)(h.Icon,{name:"document"}),(0,g.jsx)("span",{children:"Select CSV File"})]}),t&&(0,g.jsxs)(h.Box,{css:{color:"secondary"},children:[t.name," (",Math.round(t.size/1024)," KB)"]})]}),t&&(0,g.jsxs)(h.Box,{css:{stack:"y",gap:"small"},children:[(0,g.jsx)(h.Checkbox,{label:"Dry run (preview changes without applying)",checked:f,onChange:y=>k(y.target.checked)}),(0,g.jsx)(h.Button,{type:"primary",onPress:Z,disabled:s,children:s?(0,g.jsxs)(h.Box,{css:{stack:"x",gap:"xsmall",alignY:"center"},children:[(0,g.jsx)(h.Spinner,{size:"small"}),(0,g.jsx)("span",{children:"Uploading..."})]}):(0,g.jsxs)(h.Box,{css:{stack:"x",gap:"xsmall",alignY:"center"},children:[(0,g.jsx)(h.Icon,{name:"upload"}),(0,g.jsx)("span",{children:f?"Preview Import":"Import Products"})]})})]})]}),l&&a&&(0,g.jsxs)(h.Box,{css:{stack:"y",gap:"small"},children:[(0,g.jsxs)(h.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,g.jsx)(h.Spinner,{size:"small"}),(0,g.jsxs)(h.Box,{children:[f?"Previewing":"Importing",": ",We(),"% (",a.processedRows,"/",a.totalRows," rows)"]})]}),a.type==="import"&&(0,g.jsxs)(h.Box,{css:{color:"secondary",font:"caption"},children:["Created: ",(_e=a.createdCount)!=null?_e:0," | Updated: ",(ye=a.updatedCount)!=null?ye:0," | Skipped: ",(be=a.skippedCount)!=null?be:0]}),(0,g.jsx)(h.Button,{type:"destructive",onPress:Ke,children:"Cancel"})]}),a&&a.status==="completed"&&!l&&(0,g.jsx)(h.Banner,{type:"default",title:f?"Dry Run Complete":"Import Complete",description:f?`Preview: Would create ${(xe=a.createdCount)!=null?xe:0}, update ${(Se=a.updatedCount)!=null?Se:0}, skip ${(Pe=a.skippedCount)!=null?Pe:0} products.`:`Successfully created ${(ve=a.createdCount)!=null?ve:0}, updated ${(Ce=a.updatedCount)!=null?Ce:0} products. ${(Te=a.skippedCount)!=null?Te:0} skipped.`,actions:f?(0,g.jsx)(h.Button,{onPress:()=>{k(!1),u(null)},children:"Proceed with Import"}):void 0})]})},$e=Gt;var Y=B("react"),m=J(K());var w=B("react/jsx-runtime"),Kt=({api:e})=>{let[t,o]=(0,Y.useState)([]),[s,i]=(0,Y.useState)(!0),[l,p]=(0,Y.useState)(null);(0,Y.useEffect)(()=>{let n=!0,f=null,k=()=>E(void 0,null,function*(){try{let I=yield e.get("/jobs",{limit:"10"});n&&(o(I.jobs),i(!1))}catch(I){n&&(p(I instanceof Error?I.message:"Failed to load jobs"),i(!1))}});return k(),f=setInterval(()=>{t.some(S=>S.status==="pending"||S.status==="processing")&&k()},5e3),()=>{n=!1,f&&clearInterval(f)}},[e]);let a=n=>new Date(n).toLocaleString(),u=n=>{switch(n){case"pending":return(0,w.jsx)(m.Badge,{type:"info",children:"Pending"});case"processing":return(0,w.jsx)(m.Badge,{type:"warning",children:"Processing"});case"completed":return(0,w.jsx)(m.Badge,{type:"positive",children:"Completed"});case"failed":return(0,w.jsx)(m.Badge,{type:"negative",children:"Failed"});case"cancelled":return(0,w.jsx)(m.Badge,{type:"info",children:"Cancelled"});default:return(0,w.jsx)(m.Badge,{type:"info",children:n})}},d=n=>n.totalRows===0?0:Math.round(n.processedRows/n.totalRows*100);return s?(0,w.jsxs)(m.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,w.jsx)(m.Spinner,{size:"small"}),(0,w.jsx)(m.Box,{css:{color:"secondary"},children:"Loading jobs..."})]}):l?(0,w.jsxs)(m.Box,{css:{color:"critical"},children:["Error: ",l]}):t.length===0?(0,w.jsx)(m.Box,{css:{color:"secondary"},children:"No recent jobs. Start an export or import to see progress here."}):(0,w.jsx)(m.Box,{css:{stack:"y",gap:"small"},children:(0,w.jsx)(m.List,{children:t.map(n=>{var f,k,I;return(0,w.jsx)(m.ListItem,{id:n.id,title:(0,w.jsxs)(m.Box,{css:{stack:"x",gap:"small",alignY:"center"},children:[(0,w.jsx)(m.Icon,{name:n.type==="export"?"download":"upload"}),(0,w.jsx)("span",{children:n.type==="export"?"Export":"Import"}),u(n.status)]}),secondaryTitle:a(n.createdAt),children:(0,w.jsxs)(m.Box,{css:{stack:"y",gap:"xsmall"},children:[(0,w.jsx)(m.Box,{css:{color:"secondary",font:"caption"},children:n.status==="processing"?(0,w.jsxs)(m.Box,{css:{stack:"x",gap:"xsmall",alignY:"center"},children:[(0,w.jsx)(m.Spinner,{size:"small"}),(0,w.jsxs)("span",{children:[d(n),"% (",n.processedRows,"/",n.totalRows," rows)"]})]}):(0,w.jsxs)("span",{children:[n.processedRows," of ",n.totalRows," rows"]})}),n.type==="import"&&n.status==="completed"&&(0,w.jsxs)(m.Box,{css:{color:"secondary",font:"caption"},children:["Created: ",(f=n.createdCount)!=null?f:0,", Updated: ",(k=n.updatedCount)!=null?k:0,", Skipped: ",(I=n.skippedCount)!=null?I:0,n.dryRun&&(0,w.jsx)(m.Badge,{type:"info",children:"Dry Run"})]}),n.errorCount>0&&(0,w.jsxs)(m.Box,{css:{color:"attention",font:"caption"},children:[n.errorCount," errors"]})]})},n.id)})})})},Ye=Kt;var _=B("react/jsx-runtime"),Wt=({userContext:e,environment:t})=>{var s;if(!(e!=null&&e.id)||!((s=e==null?void 0:e.account)!=null&&s.id))return(0,_.jsx)(b.ContextView,{title:"Product CSV Import/Export",children:(0,_.jsxs)(b.Box,{css:{padding:"medium"},children:[(0,_.jsx)(b.Spinner,{size:"small"}),(0,_.jsx)(b.Box,{css:{marginTop:"small"},children:"Loading user context..."})]})});let o=ze({userId:e.id,accountId:e.account.id});return(0,_.jsx)(b.ContextView,{title:"Product CSV Import/Export",description:"Export products to CSV or import products from a CSV file",children:(0,_.jsxs)(b.Box,{css:{padding:"medium",stack:"y",gap:"large"},children:[(0,_.jsxs)(b.Box,{css:{stack:"y",gap:"small"},children:[(0,_.jsx)(b.Box,{css:{font:"heading",fontWeight:"semibold"},children:"Export Products"}),(0,_.jsx)(b.Box,{css:{color:"secondary"},children:"Download all your products as a CSV file for backup or editing."}),(0,_.jsx)(Ne,{api:o})]}),(0,_.jsx)(b.Divider,{}),(0,_.jsxs)(b.Box,{css:{stack:"y",gap:"small"},children:[(0,_.jsx)(b.Box,{css:{font:"heading",fontWeight:"semibold"},children:"Import Products"}),(0,_.jsx)(b.Box,{css:{color:"secondary"},children:"Upload a CSV file to create new products or update existing ones."}),(0,_.jsx)($e,{api:o})]}),(0,_.jsx)(b.Divider,{}),(0,_.jsxs)(b.Box,{css:{stack:"y",gap:"small"},children:[(0,_.jsx)(b.Box,{css:{font:"heading",fontWeight:"semibold"},children:"Recent Jobs"}),(0,_.jsx)(Ye,{api:o})]})]})})},Ge=Wt;H(M,J(de()));var Zt="2026-02-14 20:29:52.1456543 +0100 CET m=+8.644756301";var Qt={connect_permissions:null,icon:"./icon.png",id:"com.example.stripeworker-csv",name:"Product CSV Import-Export",permissions:[{permission:"product_read",purpose:"Export products to CSV"},{permission:"product_write",purpose:"Import products from CSV"}],post_install_action:{type:"external",url:"https://github.com/your-org/stripeworker#readme"},stripe_api_access_type:"platform",ui_extension:{views:[{component:"ProductListView",viewport:"stripe.dashboard.product.list"}]},version:"0.0.1"};return st(M);})();
//# sourceMappingURL=ext.min.js.map
